force_c1 = @(D1,Lx,Ly,Lz,T,c1Eq,c2Eq,c4Eq,c5Eq,c7Eq,coeff_diff,coeff_migr,coeff_time,coeff_frxn,coeff_hrxn,e,epsilon,fRxn1CRef,fRxn1MoleReactant,fRxn1ExchangeCurrent,fRxn1ActivationEnergy,fRxn1SurfaceRoughness,fRxn1TransferCoefficient,fRxn1StandardElectrodePotential,hRxnRate5,hRxnRate6,hRxnRate7,hRxnRate8,kb,na,phiEq,phiElectrode,poro,t,tort,x,y,z,z1)-coeff_hrxn.*poro.*(hRxnRate6.*(c5Eq+(c5Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0)+hRxnRate8.*(c4Eq+(c4Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0)-hRxnRate7.*(c1Eq+(c2Eq.*epsilon.*cos((z.*pi.*2.0)./Lz).*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0)-hRxnRate5.*(c7Eq+(c7Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(c1Eq+(c2Eq.*epsilon.*cos((z.*pi.*2.0)./Lz).*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0))+(D1.*coeff_diff.*poro.*((1.0./Ly.^2.*c2Eq.*epsilon.*pi.^2.*cos((y.*pi)./Ly).*cos((z.*pi.*2.0)./Lz).*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T))./2.0+1.0./Lx.^2.*c2Eq.*epsilon.*pi.^2.*cos((z.*pi.*2.0)./Lz).*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0).*2.0+1.0./Lz.^2.*c2Eq.*epsilon.*pi.^2.*cos((z.*pi.*2.0)./Lz).*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0).*2.0))./tort+(D1.*coeff_migr.*e.*poro.*z1.*(1.0./Lx.^2.*epsilon.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(c1Eq+(c2Eq.*epsilon.*cos((z.*pi.*2.0)./Lz).*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(cos((y.*pi)./Ly)+1.0).*2.0+1.0./Lz.^2.*epsilon.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(c1Eq+(c2Eq.*epsilon.*cos((z.*pi.*2.0)./Lz).*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(cos((y.*pi)./Ly)+1.0).*2.0+(1.0./Ly.^2.*epsilon.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((y.*pi)./Ly).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(c1Eq+(c2Eq.*epsilon.*cos((z.*pi.*2.0)./Lz).*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0))./2.0+1.0./Lx.^2.*c2Eq.*epsilon.^2.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).^2.*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T).^2.*(cos((y.*pi)./Ly)+1.0).^2-1.0./Lz.^2.*c2Eq.*epsilon.^2.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).*sin((x.*pi.*2.0)./Lx).*sin((z.*pi.*2.0)./Lz).^2.*sin((t.*pi.*2.0)./T).^2.*(cos((y.*pi)./Ly)+1.0).^2-(1.0./Ly.^2.*c2Eq.*epsilon.^2.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).^2.*sin((x.*pi.*2.0)./Lx).*sin((y.*pi)./Ly).^2.*sin((t.*pi.*2.0)./T).^2)./4.0))./(T.*kb.*tort)+(c2Eq.*coeff_time.*epsilon.*poro.*pi.*cos((z.*pi.*2.0)./Lz).*cos((t.*pi.*2.0)./T).*sin((x.*pi.*2.0)./Lx).*(cos((y.*pi)./Ly)+1.0))./T-(coeff_frxn.*fRxn1MoleReactant.*fRxn1ExchangeCurrent.*fRxn1SurfaceRoughness.*exp(-fRxn1ActivationEnergy./(T.*kb.*na)).*exp(-(e.*fRxn1TransferCoefficient.*(fRxn1StandardElectrodePotential+phiEq-phiElectrode+(epsilon.*phiEq.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0))./(T.*kb)).*(c1Eq+(c2Eq.*epsilon.*cos((z.*pi.*2.0)./Lz).*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0))./(e.*fRxn1CRef.*na);
force_c2 = @(D2,Lx,Ly,Lz,T,c2Eq,c3Eq,c4Eq,c5Eq,c7Eq,coeff_diff,coeff_migr,coeff_time,coeff_hrxn,e,epsilon,hRxnRate3,hRxnRate4,hRxnRate9,hRxnRate10,hRxnRate13,hRxnRate14,kb,phiEq,poro,t,tort,x,y,z,z2)-coeff_hrxn.*poro.*(hRxnRate3.*(c5Eq+(c5Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0)-hRxnRate14.*(c2Eq+(c2Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0)+hRxnRate9.*(c5Eq+(c5Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).^2-hRxnRate4.*(c2Eq+(c2Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(c3Eq+(c3Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0)-hRxnRate10.*(c2Eq+(c2Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(c4Eq+(c4Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0)+hRxnRate13.*(c5Eq+(c5Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(c7Eq+(c7Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0))+(D2.*coeff_diff.*poro.*((1.0./Ly.^2.*c2Eq.*epsilon.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((y.*pi)./Ly).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T))./2.0+1.0./Lx.^2.*c2Eq.*epsilon.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0).*2.0+1.0./Lz.^2.*c2Eq.*epsilon.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0).*2.0))./tort+(D2.*coeff_migr.*e.*poro.*z2.*(1.0./Lx.^2.*epsilon.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(c2Eq+(c2Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(cos((y.*pi)./Ly)+1.0).*2.0+1.0./Lz.^2.*epsilon.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(c2Eq+(c2Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(cos((y.*pi)./Ly)+1.0).*2.0-1.0./Lx.^2.*c2Eq.*epsilon.^2.*phiEq.*pi.^2.*cos((z.*pi.*2.0)./Lz).^2.*sin((x.*pi.*2.0)./Lx).^2.*sin((t.*pi.*2.0)./T).^2.*(cos((y.*pi)./Ly)+1.0).^2-1.0./Lz.^2.*c2Eq.*epsilon.^2.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).^2.*sin((z.*pi.*2.0)./Lz).^2.*sin((t.*pi.*2.0)./T).^2.*(cos((y.*pi)./Ly)+1.0).^2+(1.0./Ly.^2.*epsilon.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((y.*pi)./Ly).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(c2Eq+(c2Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0))./2.0-(1.0./Ly.^2.*c2Eq.*epsilon.^2.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).^2.*cos((z.*pi.*2.0)./Lz).^2.*sin((y.*pi)./Ly).^2.*sin((t.*pi.*2.0)./T).^2)./4.0))./(T.*kb.*tort)+(c2Eq.*coeff_time.*epsilon.*poro.*pi.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*cos((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./T;
force_c3 = @(D1,D3,Lx,Ly,Lz,T,c2Eq,c3Eq,c4Eq,c5Eq,c7Eq,coeff_diff,coeff_migr,coeff_time,coeff_hrxn,e,epsilon,hRxnRate1,hRxnRate2,hRxnRate3,hRxnRate4,hRxnRate15,hRxnRate16,kb,phiEq,poro,t,tort,x,y,z,z3)-coeff_hrxn.*poro.*(hRxnRate15+hRxnRate1.*(c4Eq+(c4Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0)+hRxnRate3.*(c5Eq+(c5Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0)-hRxnRate4.*(c2Eq+(c2Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(c3Eq+(c3Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0)-hRxnRate2.*(c3Eq+(c3Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(c5Eq+(c5Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0)-hRxnRate16.*(c3Eq+(c3Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(c7Eq+(c7Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0))+(D1.*coeff_diff.*poro.*((1.0./Ly.^2.*c2Eq.*epsilon.*pi.^2.*cos((y.*pi)./Ly).*cos((z.*pi.*2.0)./Lz).*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T))./2.0+1.0./Lx.^2.*c2Eq.*epsilon.*pi.^2.*cos((z.*pi.*2.0)./Lz).*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0).*2.0+1.0./Lz.^2.*c2Eq.*epsilon.*pi.^2.*cos((z.*pi.*2.0)./Lz).*sin((x.*pi.*2.0)./Lx).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0).*2.0))./tort+(D3.*coeff_migr.*e.*poro.*z3.*(1.0./Lx.^2.*epsilon.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(c3Eq+(c3Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(cos((y.*pi)./Ly)+1.0).*2.0+1.0./Lz.^2.*epsilon.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(c3Eq+(c3Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0).*(cos((y.*pi)./Ly)+1.0).*2.0-1.0./Lx.^2.*c3Eq.*epsilon.^2.*phiEq.*pi.^2.*cos((z.*pi.*2.0)./Lz).^2.*sin((x.*pi.*2.0)./Lx).^2.*sin((t.*pi.*2.0)./T).^2.*(cos((y.*pi)./Ly)+1.0).^2-1.0./Lz.^2.*c3Eq.*epsilon.^2.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).^2.*sin((z.*pi.*2.0)./Lz).^2.*sin((t.*pi.*2.0)./T).^2.*(cos((y.*pi)./Ly)+1.0).^2+(1.0./Ly.^2.*epsilon.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).*cos((y.*pi)./Ly).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(c3Eq+(c3Eq.*epsilon.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*sin((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./2.0))./2.0-(1.0./Ly.^2.*c3Eq.*epsilon.^2.*phiEq.*pi.^2.*cos((x.*pi.*2.0)./Lx).^2.*cos((z.*pi.*2.0)./Lz).^2.*sin((y.*pi)./Ly).^2.*sin((t.*pi.*2.0)./T).^2)./4.0))./(T.*kb.*tort)+(c3Eq.*coeff_time.*epsilon.*poro.*pi.*cos((x.*pi.*2.0)./Lx).*cos((z.*pi.*2.0)./Lz).*cos((t.*pi.*2.0)./T).*(cos((y.*pi)./Ly)+1.0))./T;
force_c4 = ;
force_c5 = ;
force_c6 = ;
force_c7 = ;
force_phi = ;